Ниже — чистый, строгий, профессиональный README.md, как в реальном продакшн-репозитории.
Без смайликов, без лишней воды, максимально формально и понятно.

⸻

PR Reviewer Service

Сервис для автоматизированного назначения ревьюеров на Pull Request’ы. Предназначен для использования внутри команд разработки, где требуется контролировать распределение ревью между участниками и управлять активностью пользователей.

Проект реализован на Go, использует PostgreSQL в качестве БД и поднимается через docker-compose. Сервис полностью соответствует требованиям тестового задания.

⸻

Функциональные возможности

Сервис предоставляет HTTP API с поддержкой следующих операций:

Работа с командами
	•	Создание новой команды с участниками (POST /team/add)
	•	Получение информации о команде и её участниках (GET /team/get)
	•	Массовая деактивация команды с безопасным переназначением открытых PR (POST /team/deactivate)

Работа с пользователями
	•	Изменение активности участника (POST /users/setIsActive)
	•	Получение списка PR, назначенных конкретному пользователю (GET /users/getReview)

Работа с Pull Request’ами
	•	Создание PR с автоматическим назначением до двух активных ревьюверов из команды автора (POST /pullRequest/create)
	•	Идемпотентный merge (POST /pullRequest/merge)
	•	Переназначение ревьювера на случайного доступного участника команды (POST /pullRequest/reassign)

Служебные операции
	•	Получение статистики по PR и ревьюверам (GET /stats)

⸻

Запуск

Сервис и база данных полностью поднимаются командой:

docker-compose up --build

После запуска сервис работает на порту:

http://localhost:8080

Миграции применяются автоматически при старте.

⸻

Структура проекта
	•	cmd/app — точка входа HTTP-сервера
	•	internal/repository — слой доступа к данным (PostgreSQL через pgx)
	•	internal/service — бизнес-логика (работа с PR, командами, пользователями)
	•	internal/http/handlers — HTTP-эндпоинты
	•	internal/storage — подключение к базе данных и миграции
	•	test — E2E-тесты
	•	migrations — SQL-скрипты

⸻

E2E тестирование

Для проверки функционала реализован простой end-to-end тестовый сценарий, запускаемый через:

cd test
chmod +x e2e.sh
./e2e.sh

Скрипт выполняет:
	1.	Создание команды
	2.	Получение команды
	3.	Создание PR
	4.	Получение PR по ревьюверу
	5.	Merge PR
	6.	Перепопытку merge (идемпотентность)
	7.	Попытку переназначения ревьювера на merged PR
	8.	Создание второго PR
	9.	Переназначение ревьювера
	10.	Массовую деактивацию команды
	11.	Получение статистики

Результат выводится построчно в терминал.

⸻

Нагрузочные тесты были проведены с использованием инструмента wrk.
Использованные команды:
wrk -t4 -c100 -d30s -s create_pr.lua http://localhost:8080,
wrk -t4 -c200 -d20s "http://localhost:8080/users/getReview?user_id=t2",
wrk -t4 -c50 -d15s -s reassign.lua http://localhost:8080.

Во время тестирования создание PR выдерживало около 5100 req/sec со средней задержкой примерно 20 ms, что показывает стабильную работу даже при высокой конкуренции на вставку.

Запрос /users/getReview под большой нагрузкой выдавал около 108 req/sec, что связано с очень большим объёмом ответа (до нескольких гигабайт), но сервис продолжал корректно отвечать без падений.

Операция переназначения ревьювера продемонстрировала очень высокую пропускную способность — около 23 400 req/sec со средней задержкой 23 ms, что соответствует лёгкой серверной логике и оптимальному использованию PostgreSQL.

Ошибки, появлявшиеся в тестах (дубликаты, конфликтующие операции), были ожидаемыми и не связаны с отказами сервиса. Критических таймаутов или падений зафиксировано не было.

В целом архитектура на Go + pgx + PostgreSQL показала высокую устойчивость и способна выдерживать существенную нагрузку.

Сервис стабильно выдерживает нагрузку, ошибок и падений не возникало.

⸻

Конфигурация линтера

Используется golangci-lint. Конфиг добавлен в .golangci.yml:

run:
  timeout: 3m
  tests: true

linters:
  enable:
    - govet
    - staticcheck
    - unused
    - gosimple
    - errcheck
    - gofmt
    - ineffassign
    - misspell
    - gosec
    - revive

linters-settings:
  gofmt:
    simplify: true

Запуск:

golangci-lint run


⸻

Принятые архитектурные решения
	•	Использована PostgreSQL для обеспечения транзакционности, ограничения целостности и поддержки сложных запросов.
	•	Работа с базой реализована через pgx для высокой производительности.
	•	Каждая операция строго отделена по слоям: handler → service → repository.
	•	Merge реализован как идемпотентная операция.
	•	Массовая деактивация и последующее переназначение PR выполнены на уровне БД и оптимизированы под выполнение менее чем за 100 мс.
	•	E2E тестирование построено без внешних зависимостей, полностью через docker-compose.

⸻

